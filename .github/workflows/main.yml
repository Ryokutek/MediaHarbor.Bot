name: CI to Docker Hub

on:
  push:
    branches: [ main ]
  
jobs:
  Deploy:
    runs-on: ryokutek-raspberrypi

    env:
      MEDIA_HARBOR_BOT_TOKEN: ${{ secrets.MEDIA_HARBOR_BOT_TOKEN }}
      REDIS_PASSWORD: password
      
    steps:
    - name: Checkout
      uses: actions/checkout@v2
      
    - name: MediaHarbor.Bot Down
      run: sudo docker compose down
      continue-on-error: true
      
    - name: MediaHarbor.Bot Update
      run: sudo docker compose pull
      
    - name: MediaHarbor.Bot Up
      run: sudo docker compose up -d
